<!DOCTYPE html>
<html devsite>

<head>
  <meta name="project_path" value="/web/tools/_project.yaml" />
  <meta name="book_path" value="/web/tools/_book.yaml" />
  <meta name="gtm_var" data-key="docType" data-value="reference">
  <title>Class: DBWrapper</title>
  <link href="jsdoc.css" rel="stylesheet">
</head>

<body>
  <div id="jsdoc-body-container">
    <div id="jsdoc-content">
      <div id="jsdoc-content-container">
        <div id="jsdoc-main" role="main">
          <header class="page-header">
            <h1><small></small><span class="symbol-name">DBWrapper</span></h1>
            <div class="symbol-detail-labels"><span class="label label-kind"><small>class</small></span></div>
            <p>A class that wraps common IndexedDB functionality in a promise-based API. It exposes all the underlying power and functionality of IndexedDB, but wraps the most commonly used features in a way that's much simpler to use.</p>
          </header>
          <section>
            <h2>Constructor</h2>
            <section>
              <h3 id="DBWrapper" class="symbol-name">DBWrapper</h3>
              <p class="type-signature"> new DBWrapper(name, version, callback)</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>name</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>version</p>
                      </td>
                      <td>
                        <p class="details-table-types">number</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>callback</p>
                      </td>
                      <td>
                        <p class="details-table-optional">Optional</p>
                        <p class="details-table-types">Object</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>callbacks.onupgradeneeded</p>
                      </td>
                      <td>
                        <p class="details-table-optional">Optional</p>
                        <p class="details-table-types">function(Event)</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>callbacks.onversionchange</p>
                      </td>
                      <td>
                        <p class="details-table-optional">Optional</p>
                        <p class="details-table-types">function(Event)</p>
                        <p>Defaults to DBWrapper.prototype._onversionchange when not specified.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
              </dl>
            </section>
          </section>
          <section>
            <h2>Methods</h2>
            <section>
              <h3 id="_call" class="symbol-name">_call</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> _call(method, storeName, type, ...args)&nbsp;returns&nbsp;any type</p>
              <p>Delegates async to a native IDBObjectStore method.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>method</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>The method name.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>The object store name.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>type</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>Can be <code>readonly</code> or <code>readwrite</code>.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>args</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                        <p>The list of args to pass to the native method.</p>
                        <p>Value may be repeated.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>any type</code>&nbsp;The result of the transaction.</p>
                </dd>
              </dl>
              <h3 id="_onversionchange" class="symbol-name">_onversionchange</h3>
              <p class="type-signature"> _onversionchange(evt)</p>
              <p>The default onversionchange handler, which closes the database so other connections can open without being blocked.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>evt</p>
                      </td>
                      <td>
                        <p class="details-table-types">Event</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
              </dl>
              <h3 id="add" class="symbol-name">add</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> add(storeName, ...args)&nbsp;returns&nbsp;any type</p>
              <p>Delegates to the native <code>add()</code> method for the object store.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>The name of the object store to put the value.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>args</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                        <p>The values passed to the delegated method.</p>
                        <p>Value may be repeated.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>any type</code>&nbsp;The key of the entry.</p>
                </dd>
              </dl>
              <h3 id="close" class="symbol-name">close</h3>
              <p class="type-signature"> close()</p>
              <p>Closes the connection opened by <code>DBWrapper.open()</code>. Generally this method doesn't need to be called since:</p>
              <ol>
                <li>It's usually better to keep a connection open since opening a new connection is somewhat slow.</li>
                <li>Connections are automatically closed when the reference is garbage collected. The primary use case for needing to close a connection is when another reference (typically in another tab) needs to upgrade it and would be blocked by the current,
                  open connection.</li>
              </ol>
              <dl class="dl-compact">
              </dl>
              <h3 id="delete" class="symbol-name">delete</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> delete(storeName, ...args)</p>
              <p>Delegates to the native <code>delete()</code> method for the object store.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>args</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                        <p>The values passed to the delegated method.</p>
                        <p>Value may be repeated.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
              </dl>
              <h3 id="get" class="symbol-name">get</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> get(storeName, ...args)&nbsp;returns&nbsp;any type</p>
              <p>Delegates to the native <code>get()</code> method for the object store.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>The name of the object store to put the value.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>args</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                        <p>The values passed to the delegated method.</p>
                        <p>Value may be repeated.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>any type</code>&nbsp;The key of the entry.</p>
                </dd>
              </dl>
              <h3 id="getAll" class="symbol-name">getAll</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> getAll(storeName, query, count)&nbsp;returns&nbsp;Array</p>
              <p>Delegates to the native <code>getAll()</code> or polyfills it via the <code>find()</code> method in older browsers.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>query</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>count</p>
                      </td>
                      <td>
                        <p class="details-table-types">number</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>Array</code>&nbsp;</p>
                </dd>
              </dl>
              <h3 id="getAllMatching" class="symbol-name">getAllMatching</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> getAllMatching(storeName, opts)&nbsp;returns&nbsp;Array</p>
              <p>Supports flexible lookup in an object store by specifying an index, query, direction, and count. This method returns an array of objects with the signature .</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>opts</p>
                      </td>
                      <td>
                        <p class="details-table-optional">Optional</p>
                        <p class="details-table-types">Object</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>Array</code>&nbsp;</p>
                </dd>
              </dl>
              <h3 id="open" class="symbol-name">open</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> open()&nbsp;returns&nbsp;IDBDatabase</p>
              <p>Opens a connected to an IDBDatabase, invokes any onupgradedneeded callback, and added an onversionchange callback to the database.</p>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>IDBDatabase</code>&nbsp;</p>
                </dd>
              </dl>
              <h3 id="put" class="symbol-name">put</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> put(storeName, ...args)&nbsp;returns&nbsp;any type</p>
              <p>Delegates to the native <code>put()</code> method for the object store.</p>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeName</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>The name of the object store to put the value.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>args</p>
                      </td>
                      <td>
                        <p class="details-table-types">any type</p>
                        <p>The values passed to the delegated method.</p>
                        <p>Value may be repeated.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>any type</code>&nbsp;The key of the entry.</p>
                </dd>
              </dl>
              <h3 id="transaction" class="symbol-name">transaction</h3>
              <div class="symbol-detail-labels"><span class="label label-async"><small>async</small></span></div>
              <p class="type-signature"> transaction(storeNames, type, callback)&nbsp;returns&nbsp;any type</p>
              <p>Accepts a list of stores, a transaction type, and a callback and performs a transaction. A promise is returned that resolves to whatever value the callback chooses. The callback holds all the transaction logic and is invoked with three arguments:</p>
              <ol>
                <li>An object mapping object store names to IDBObjectStore values.</li>
                <li>A <code>done</code> function, that's used to resolve the promise when when the transaction is done.</li>
                <li>An <code>abort</code> function that can be called to abort the transaction at any time.</li>
              </ol>
              <section>
                <table class="function param responsive">
                  <tr>
                    <th colspan="2">
                      <h4>Parameter</h4>
                    </th>
                  </tr>
                  <tbody>
                    <tr>
                      <td class="details-table-name">
                        <p>storeNames</p>
                      </td>
                      <td>
                        <p class="details-table-types">Array of string</p>
                        <p>An array of object store names involved in the transaction.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>type</p>
                      </td>
                      <td>
                        <p class="details-table-types">string</p>
                        <p>Can be <code>readonly</code> or <code>readwrite</code>.</p>
                      </td>
                    </tr>
                    <tr>
                      <td class="details-table-name">
                        <p>callback</p>
                      </td>
                      <td>
                        <p class="details-table-types">function(Object, function(), function(any type))</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </section>
              <dl class="dl-compact">
                <dt>Returns</dt>
                <dd>
                  <p><code>any type</code>&nbsp;The result of the transaction ran by the callback.</p>
                </dd>
              </dl>
            </section>
          </section>
        </div>
      </div>
      <nav id="jsdoc-toc-nav" role="navigation"></nav>
    </div>
  </div>
</body>

</html>